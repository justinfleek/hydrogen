// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
//                                                         // hydrogen // model
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// | 3D Model Component
// |
// | Load and display 3D models with support for GLTF/GLB format,
// | animations, material overrides, and inspection tools.
// |
// | ## Usage
// |
// | ```purescript
// | import Hydrogen.ThreeD.Model as Model
// |
// | -- Simple model viewer
// | Model.model
// |   { url: "/models/robot.glb"
// |   , onLoad: Just HandleModelLoaded
// |   }
// |
// | -- With animation playback
// | Model.modelWithProps
// |   Model.defaultModelProps
// |     { url = "/models/character.glb"
// |     , playAnimation = Just "walk"
// |     , animationLoop = true
// |     , animationSpeed = 1.0
// |     }
// |
// | -- With material override
// | Model.modelWithProps
// |   Model.defaultModelProps
// |     { url = "/models/car.glb"
// |     , materialOverride = Just
// |         { color: "#ff0000"
// |         , metalness: 0.9
// |         , roughness: 0.1
// |         }
// |     , wireframe = true
// |     }
// |
// | -- With bounding box display
// | Model.modelWithProps
// |   Model.defaultModelProps
// |     { url = "/models/sculpture.glb"
// |     , showBoundingBox = true
// |     , autoCenter = true
// |     , autoScale = true
// |     }
// |
// | -- Get model info
// | Model.modelWithProps
// |   Model.defaultModelProps
// |     { url = "/models/scene.glb"
// |     , onModelInfo = Just \info ->
// |         Console.log $ "Vertices: " <> show info.vertices
// |     }
// | ```
import * as $foreign from "./foreign.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Hydrogen_UI_Core from "../Hydrogen.UI.Core/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showBoolean);
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                // load state
// ═══════════════════════════════════════════════════════════════════════════════
// | Model loading state
var Loading = /* #__PURE__ */ (function () {
    function Loading(value0) {
        this.value0 = value0;
    };
    Loading.create = function (value0) {
        return new Loading(value0);
    };
    return Loading;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                // load state
// ═══════════════════════════════════════════════════════════════════════════════
// | Model loading state
var Loaded = /* #__PURE__ */ (function () {
    function Loaded(value0) {
        this.value0 = value0;
    };
    Loaded.create = function (value0) {
        return new Loaded(value0);
    };
    return Loaded;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                // load state
// ═══════════════════════════════════════════════════════════════════════════════
// | Model loading state
var $$Error = /* #__PURE__ */ (function () {
    function $$Error(value0) {
        this.value0 = value0;
    };
    $$Error.create = function (value0) {
        return new $$Error(value0);
    };
    return $$Error;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                  // internal
// ═══════════════════════════════════════════════════════════════════════════════
// | Convert Vector3 to string
var vector3ToString = function (v) {
    return show(v.x) + ("," + (show(v.y) + ("," + show(v.z))));
};
var stopAnimation = $foreign.stopAnimationImpl;
var setScale = $foreign.setScaleImpl;
var setRotation = $foreign.setRotationImpl;
var setPosition = $foreign.setPositionImpl;
var setAnimationTime = $foreign.setAnimationTimeImpl;
var setAnimationSpeed = $foreign.setAnimationSpeedImpl;
var playAnimation = $foreign.playAnimationImpl;
var pauseAnimation = $foreign.pauseAnimationImpl;

// | Handler for progress event
var onProgress = function (v) {
    return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.attr("data-model-event")("progress"), Halogen_HTML_Properties.style("display: none") ])([  ]);
};

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                   // events
// ═══════════════════════════════════════════════════════════════════════════════
// | Handler for model load event
var onLoad = function (v) {
    return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.attr("data-model-event")("load"), Halogen_HTML_Properties.style("display: none") ])([  ]);
};

// | Handler for error event
var onError = function (v) {
    return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.attr("data-model-event")("error"), Halogen_HTML_Properties.style("display: none") ])([  ]);
};

// | Handler for animation finish event
var onAnimationFinish = function (v) {
    return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.attr("data-model-event")("animationfinish"), Halogen_HTML_Properties.style("display: none") ])([  ]);
};

// ═══════════════════════════════════════════════════════════════════════════════
//                                                          // model component
// ═══════════════════════════════════════════════════════════════════════════════
// | Simple model component
var model = function (config) {
    return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.attr("data-model-viewer")("true"), Halogen_HTML_Properties.attr("data-model-url")(config.url), Halogen_HTML_Properties.attr("data-auto-center")("true"), Halogen_HTML_Properties.attr("data-cast-shadow")("true"), Halogen_HTML_Properties.attr("data-receive-shadow")("true"), Hydrogen_UI_Core.cls([ "relative" ]) ])([  ]);
};

// | Convert material override to string
var materialOverrideToString = function (m) {
    var maybeFieldNum = function (v) {
        return function (v1) {
            if (v1 instanceof Data_Maybe.Just) {
                return v + ("=" + (show(v1.value0) + ";"));
            };
            if (v1 instanceof Data_Maybe.Nothing) {
                return "";
            };
            throw new Error("Failed pattern match at Hydrogen.ThreeD.Model (line 526, column 3 - line 526, column 52): " + [ v.constructor.name, v1.constructor.name ]);
        };
    };
    var maybeFieldBool = function (v) {
        return function (v1) {
            if (v1 instanceof Data_Maybe.Just) {
                return v + ("=" + (show1(v1.value0) + ";"));
            };
            if (v1 instanceof Data_Maybe.Nothing) {
                return "";
            };
            throw new Error("Failed pattern match at Hydrogen.ThreeD.Model (line 530, column 3 - line 530, column 54): " + [ v.constructor.name, v1.constructor.name ]);
        };
    };
    var maybeField = function (v) {
        return function (v1) {
            if (v1 instanceof Data_Maybe.Just) {
                return v + ("=" + (v1.value0 + ";"));
            };
            if (v1 instanceof Data_Maybe.Nothing) {
                return "";
            };
            throw new Error("Failed pattern match at Hydrogen.ThreeD.Model (line 522, column 3 - line 522, column 49): " + [ v.constructor.name, v1.constructor.name ]);
        };
    };
    return maybeField("color")(m.color) + (maybeFieldNum("metalness")(m.metalness) + (maybeFieldNum("roughness")(m.roughness) + (maybeField("emissive")(m.emissive) + (maybeFieldNum("emissiveIntensity")(m.emissiveIntensity) + (maybeFieldNum("opacity")(m.opacity) + (maybeFieldBool("transparent")(m.transparent) + maybeFieldNum("envMapIntensity")(m.envMapIntensity)))))));
};
var getScale = $foreign.getScaleImpl;
var getRotation = $foreign.getRotationImpl;
var getPosition = $foreign.getPositionImpl;
var getModelRef = $foreign.getModelRefImpl;
var getModelInfo = $foreign.getModelInfoImpl;
var getBoundingBox = $foreign.getBoundingBoxImpl;
var getAnimationClips = $foreign.getAnimationClipsImpl;

// | Convert Euler to string
var eulerToString = function (e) {
    return show(e.x) + ("," + (show(e.y) + ("," + show(e.z))));
};

// | Model component with full props
var modelWithProps = function (props) {
    var materialAttr = (function () {
        if (props.materialOverride instanceof Data_Maybe.Just) {
            return [ Halogen_HTML_Elements.div([ Halogen_HTML_Properties.attr("data-material-override")(materialOverrideToString(props.materialOverride.value0)), Halogen_HTML_Properties.style("display: none") ])([  ]) ];
        };
        if (props.materialOverride instanceof Data_Maybe.Nothing) {
            return [  ];
        };
        throw new Error("Failed pattern match at Hydrogen.ThreeD.Model (line 350, column 18 - line 358, column 18): " + [ props.materialOverride.constructor.name ]);
    })();
    var animationAttr = (function () {
        if (props.playAnimation instanceof Data_Maybe.Just) {
            return [ Halogen_HTML_Elements.div([ Halogen_HTML_Properties.attr("data-play-animation")(props.playAnimation.value0), Halogen_HTML_Properties.style("display: none") ])([  ]) ];
        };
        if (props.playAnimation instanceof Data_Maybe.Nothing) {
            return [  ];
        };
        throw new Error("Failed pattern match at Hydrogen.ThreeD.Model (line 340, column 19 - line 348, column 18): " + [ props.playAnimation.constructor.name ]);
    })();
    return Halogen_HTML_Elements.div([ Halogen_HTML_Properties.attr("data-model-viewer")("true"), Halogen_HTML_Properties.attr("data-model-url")(props.url), Halogen_HTML_Properties.attr("data-model-position")(vector3ToString(props.position)), Halogen_HTML_Properties.attr("data-model-rotation")(eulerToString(props.rotation)), Halogen_HTML_Properties.attr("data-model-scale")(show(props.scale)), Halogen_HTML_Properties.attr("data-auto-center")(show1(props.autoCenter)), Halogen_HTML_Properties.attr("data-auto-scale")(show1(props.autoScale)), Halogen_HTML_Properties.attr("data-target-size")(show(props.targetSize)), Halogen_HTML_Properties.attr("data-cast-shadow")(show1(props.castShadow)), Halogen_HTML_Properties.attr("data-receive-shadow")(show1(props.receiveShadow)), Halogen_HTML_Properties.attr("data-wireframe")(show1(props.wireframe)), Halogen_HTML_Properties.attr("data-show-bbox")(show1(props.showBoundingBox)), Halogen_HTML_Properties.attr("data-animation-loop")(show1(props.animationLoop)), Halogen_HTML_Properties.attr("data-animation-speed")(show(props.animationSpeed)), Halogen_HTML_Properties.attr("data-animation-crossfade")(show(props.animationCrossFade)), Halogen_HTML_Properties.attr("data-model-name")(props.name), Hydrogen_UI_Core.cls([ "relative", props.className ]) ])(append1(animationAttr)(materialAttr));
};

// | Default model properties
var defaultModelProps = /* #__PURE__ */ (function () {
    return {
        url: "",
        position: {
            x: 0.0,
            y: 0.0,
            z: 0.0
        },
        rotation: {
            x: 0.0,
            y: 0.0,
            z: 0.0
        },
        scale: 1.0,
        autoCenter: true,
        autoScale: false,
        targetSize: 2.0,
        castShadow: true,
        receiveShadow: true,
        wireframe: false,
        showBoundingBox: false,
        materialOverride: Data_Maybe.Nothing.value,
        playAnimation: Data_Maybe.Nothing.value,
        animationLoop: true,
        animationSpeed: 1.0,
        animationCrossFade: 0.3,
        onLoad: Data_Maybe.Nothing.value,
        onProgress: Data_Maybe.Nothing.value,
        onError: Data_Maybe.Nothing.value,
        onAnimationFinish: Data_Maybe.Nothing.value,
        onModelInfo: Data_Maybe.Nothing.value,
        className: "",
        name: ""
    };
})();

// | Default material override (no changes)
var defaultMaterialOverride = /* #__PURE__ */ (function () {
    return {
        color: Data_Maybe.Nothing.value,
        metalness: Data_Maybe.Nothing.value,
        roughness: Data_Maybe.Nothing.value,
        emissive: Data_Maybe.Nothing.value,
        emissiveIntensity: Data_Maybe.Nothing.value,
        opacity: Data_Maybe.Nothing.value,
        transparent: Data_Maybe.Nothing.value,
        envMapIntensity: Data_Maybe.Nothing.value
    };
})();
export {
    model,
    modelWithProps,
    defaultModelProps,
    Loading,
    Loaded,
    $$Error as Error,
    playAnimation,
    pauseAnimation,
    stopAnimation,
    setAnimationTime,
    setAnimationSpeed,
    getAnimationClips,
    defaultMaterialOverride,
    getModelInfo,
    getModelRef,
    setPosition,
    setRotation,
    setScale,
    getPosition,
    getRotation,
    getScale,
    getBoundingBox,
    onLoad,
    onProgress,
    onError,
    onAnimationFinish
};
