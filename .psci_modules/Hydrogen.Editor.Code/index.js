// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
//                                                     // hydrogen // code-editor
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// | Full-featured code editor component
// |
// | A Monaco/CodeMirror-style code editor with syntax highlighting, line numbers,
// | code folding, multiple cursors, find & replace, and comprehensive keyboard
// | shortcuts.
// |
// | ## Features
// |
// | - Syntax highlighting for JS, TS, HTML, CSS, JSON, Markdown, PureScript
// | - Line numbers with gutter
// | - Current line highlighting
// | - Code folding
// | - Auto-indentation
// | - Tab handling (tabs vs spaces, configurable)
// | - Bracket matching
// | - Auto-closing brackets/quotes
// | - Multiple cursors (Ctrl+D)
// | - Find & Replace (Ctrl+F, Ctrl+H)
// | - Go to line (Ctrl+G)
// | - Minimap (optional)
// | - Word wrap toggle
// | - Theme support (light/dark)
// | - Read-only mode
// | - Diff view (two-pane comparison)
// | - Error/warning gutters (line markers)
// |
// | ## Usage
// |
// | ```purescript
// | import Hydrogen.Editor.Code as Code
// |
// | -- Basic editor
// | Code.codeEditor
// |   [ Code.value "console.log('Hello, world!')"
// |   , Code.language Code.JavaScript
// |   , Code.onChange HandleChange
// |   ]
// |
// | -- With line numbers and theme
// | Code.codeEditor
// |   [ Code.value state.code
// |   , Code.language Code.TypeScript
// |   , Code.lineNumbers true
// |   , Code.theme Code.Dark
// |   , Code.onChange UpdateCode
// |   ]
// |
// | -- Read-only with minimap
// | Code.codeEditor
// |   [ Code.value sourceCode
// |   , Code.language Code.PureScript
// |   , Code.readOnly true
// |   , Code.minimap true
// |   ]
// |
// | -- Diff view
// | Code.diffEditor
// |   [ Code.original originalCode
// |   , Code.modified modifiedCode
// |   , Code.language Code.JSON
// |   ]
// |
// | -- With error markers
// | Code.codeEditor
// |   [ Code.value state.code
// |   , Code.language Code.TypeScript
// |   , Code.markers
// |       [ Code.errorMarker 5 "Type error: ..."
// |       , Code.warningMarker 10 "Unused variable"
// |       ]
// |   ]
// | ```
// |
// | ## Keyboard Shortcuts
// |
// | | Shortcut | Action |
// | |----------|--------|
// | | Ctrl+F | Find |
// | | Ctrl+H | Replace |
// | | Ctrl+G | Go to line |
// | | Ctrl+D | Add cursor at next occurrence |
// | | Ctrl+/ | Toggle comment |
// | | Ctrl+Z | Undo |
// | | Ctrl+Shift+Z | Redo |
// | | Alt+Up | Move line up |
// | | Alt+Down | Move line down |
// | | Alt+Shift+Up | Copy line up |
// | | Alt+Shift+Down | Copy line down |
// | | Tab | Indent |
// | | Shift+Tab | Outdent |
// | | Ctrl+] | Indent line |
// | | Ctrl+[ | Outdent line |
import * as $foreign from "./foreign.js";
import * as DOM_HTML_Indexed_InputType from "../DOM.HTML.Indexed.InputType/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_Common from "../Data.String.Common/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect from "../Effect/index.js";
import * as Effect_Ref from "../Effect.Ref/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Halogen_HTML_Properties_ARIA from "../Halogen.HTML.Properties.ARIA/index.js";
import * as Hydrogen_UI_Core from "../Hydrogen.UI.Core/index.js";
var type_ = /* #__PURE__ */ Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropInputType);
var value1 = /* #__PURE__ */ Halogen_HTML_Properties.value(Halogen_HTML_Core.isPropString);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var max = /* #__PURE__ */ Data_Ord.max(Data_Ord.ordInt);

// | Color theme
var Light = /* #__PURE__ */ (function () {
    function Light() {

    };
    Light.value = new Light();
    return Light;
})();

// | Color theme
var Dark = /* #__PURE__ */ (function () {
    function Dark() {

    };
    Dark.value = new Dark();
    return Dark;
})();

// | Marker severity levels
var $$Error = /* #__PURE__ */ (function () {
    function $$Error() {

    };
    $$Error.value = new $$Error();
    return $$Error;
})();

// | Marker severity levels
var Warning = /* #__PURE__ */ (function () {
    function Warning() {

    };
    Warning.value = new Warning();
    return Warning;
})();

// | Marker severity levels
var Info = /* #__PURE__ */ (function () {
    function Info() {

    };
    Info.value = new Info();
    return Info;
})();

// | Marker severity levels
var Hint = /* #__PURE__ */ (function () {
    function Hint() {

    };
    Hint.value = new Hint();
    return Hint;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                       // types
// ═══════════════════════════════════════════════════════════════════════════════
// | Supported programming languages
var JavaScript = /* #__PURE__ */ (function () {
    function JavaScript() {

    };
    JavaScript.value = new JavaScript();
    return JavaScript;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                       // types
// ═══════════════════════════════════════════════════════════════════════════════
// | Supported programming languages
var TypeScript = /* #__PURE__ */ (function () {
    function TypeScript() {

    };
    TypeScript.value = new TypeScript();
    return TypeScript;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                       // types
// ═══════════════════════════════════════════════════════════════════════════════
// | Supported programming languages
var HTML = /* #__PURE__ */ (function () {
    function HTML() {

    };
    HTML.value = new HTML();
    return HTML;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                       // types
// ═══════════════════════════════════════════════════════════════════════════════
// | Supported programming languages
var CSS = /* #__PURE__ */ (function () {
    function CSS() {

    };
    CSS.value = new CSS();
    return CSS;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                       // types
// ═══════════════════════════════════════════════════════════════════════════════
// | Supported programming languages
var $$JSON = /* #__PURE__ */ (function () {
    function $$JSON() {

    };
    $$JSON.value = new $$JSON();
    return $$JSON;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                       // types
// ═══════════════════════════════════════════════════════════════════════════════
// | Supported programming languages
var Markdown = /* #__PURE__ */ (function () {
    function Markdown() {

    };
    Markdown.value = new Markdown();
    return Markdown;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                       // types
// ═══════════════════════════════════════════════════════════════════════════════
// | Supported programming languages
var PureScript = /* #__PURE__ */ (function () {
    function PureScript() {

    };
    PureScript.value = new PureScript();
    return PureScript;
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                       // types
// ═══════════════════════════════════════════════════════════════════════════════
// | Supported programming languages
var PlainText = /* #__PURE__ */ (function () {
    function PlainText() {

    };
    PlainText.value = new PlainText();
    return PlainText;
})();

// | Editor ref for imperative operations
var EditorRef = function (x) {
    return x;
};

// | Toggle word wrap
var wordWrap = function (ww) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            wordWrap: ww
        };
    };
};

// | Warning marker classes
var warningMarkerClasses = "bg-yellow-500/20 border-l-2 border-yellow-500";

// | Create a warning marker
var warningMarker = function (line) {
    return function (message) {
        return {
            line: line,
            column: 1,
            endLine: line,
            endColumn: 1000,
            message: message,
            severity: Warning.value
        };
    };
};

// ═══════════════════════════════════════════════════════════════════════════════
//                                                              // prop builders
// ═══════════════════════════════════════════════════════════════════════════════
// | Set editor value
var value = function (v) {
    return function (props) {
        return {
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            value: v
        };
    };
};

// | Use tabs instead of spaces
var useTabs = function (ut) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            useTabs: ut
        };
    };
};

// | Unfold all code blocks
var unfoldAll = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Unit.unit;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            return $foreign.unfoldAllImpl(maybeHandle.value0);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1197, column 3 - line 1199, column 53): " + [ maybeHandle.constructor.name ]);
    };
};

// | Undo last edit
var undo = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Unit.unit;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            return $foreign.undoImpl(maybeHandle.value0);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1125, column 3 - line 1127, column 48): " + [ maybeHandle.constructor.name ]);
    };
};

// | Set color theme
var theme = function (t) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            theme: t
        };
    };
};

// | Set tab size
var tabSize = function (ts) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            tabSize: ts
        };
    };
};
var showTheme = {
    show: function (v) {
        if (v instanceof Light) {
            return "light";
        };
        if (v instanceof Dark) {
            return "dark";
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 228, column 1 - line 230, column 21): " + [ v.constructor.name ]);
    }
};
var show1 = /* #__PURE__ */ Data_Show.show(showTheme);
var showMarkerSeverity = {
    show: function (v) {
        if (v instanceof $$Error) {
            return "error";
        };
        if (v instanceof Warning) {
            return "warning";
        };
        if (v instanceof Info) {
            return "info";
        };
        if (v instanceof Hint) {
            return "hint";
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 241, column 1 - line 245, column 21): " + [ v.constructor.name ]);
    }
};
var show2 = /* #__PURE__ */ Data_Show.show(showMarkerSeverity);
var showLanguage = {
    show: function (v) {
        if (v instanceof JavaScript) {
            return "javascript";
        };
        if (v instanceof TypeScript) {
            return "typescript";
        };
        if (v instanceof HTML) {
            return "html";
        };
        if (v instanceof CSS) {
            return "css";
        };
        if (v instanceof $$JSON) {
            return "json";
        };
        if (v instanceof Markdown) {
            return "markdown";
        };
        if (v instanceof PureScript) {
            return "purescript";
        };
        if (v instanceof PlainText) {
            return "plaintext";
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 211, column 1 - line 219, column 31): " + [ v.constructor.name ]);
    }
};
var show3 = /* #__PURE__ */ Data_Show.show(showLanguage);

// | Set editor value
var setValue = function (v) {
    return function (val) {
        return function __do() {
            var maybeHandle = Effect_Ref.read(v)();
            if (maybeHandle instanceof Data_Maybe.Nothing) {
                return Data_Unit.unit;
            };
            if (maybeHandle instanceof Data_Maybe.Just) {
                return $foreign.setValueImpl(maybeHandle.value0, val);
            };
            throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1065, column 3 - line 1067, column 56): " + [ maybeHandle.constructor.name ]);
        };
    };
};

// | Set selection
var setSelection = function (v) {
    return function (sel) {
        return function __do() {
            var maybeHandle = Effect_Ref.read(v)();
            if (maybeHandle instanceof Data_Maybe.Nothing) {
                return Data_Unit.unit;
            };
            if (maybeHandle instanceof Data_Maybe.Just) {
                return $foreign.setSelectionImpl(maybeHandle.value0, sel);
            };
            throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1083, column 3 - line 1085, column 60): " + [ maybeHandle.constructor.name ]);
        };
    };
};

// | Set cursor position
var setCursorPosition = function (v) {
    return function (pos) {
        return function __do() {
            var maybeHandle = Effect_Ref.read(v)();
            if (maybeHandle instanceof Data_Maybe.Nothing) {
                return Data_Unit.unit;
            };
            if (maybeHandle instanceof Data_Maybe.Just) {
                return $foreign.setCursorPositionImpl(maybeHandle.value0, pos);
            };
            throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1101, column 3 - line 1103, column 65): " + [ maybeHandle.constructor.name ]);
        };
    };
};

// | Replace all matches
var replaceAll = function (v) {
    return function (searchText) {
        return function (replaceText) {
            return function __do() {
                var maybeHandle = Effect_Ref.read(v)();
                if (maybeHandle instanceof Data_Maybe.Nothing) {
                    return Data_Unit.unit;
                };
                if (maybeHandle instanceof Data_Maybe.Just) {
                    return $foreign.replaceAllImpl(maybeHandle.value0, searchText, replaceText);
                };
                throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1165, column 3 - line 1167, column 77): " + [ maybeHandle.constructor.name ]);
            };
        };
    };
};

// | Replace current match
var replace = function (v) {
    return function (searchText) {
        return function (replaceText) {
            return function __do() {
                var maybeHandle = Effect_Ref.read(v)();
                if (maybeHandle instanceof Data_Maybe.Nothing) {
                    return Data_Unit.unit;
                };
                if (maybeHandle instanceof Data_Maybe.Just) {
                    return $foreign.replaceImpl(maybeHandle.value0, searchText, replaceText);
                };
                throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1157, column 3 - line 1159, column 74): " + [ maybeHandle.constructor.name ]);
            };
        };
    };
};

// | Render editor toolbar
var renderToolbar = function (_props) {
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "hidden absolute top-0 left-0 right-0 z-10 flex items-center gap-2 px-2 py-1 bg-muted/50 border-b border-border" ]), Halogen_HTML_Properties.attr("data-toolbar")("true") ])([ Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "hidden flex-1 max-w-xs" ]), Halogen_HTML_Properties.attr("data-find-container")("true") ])([ Halogen_HTML_Elements.input([ Hydrogen_UI_Core.cls([ "flex h-7 w-full rounded-md border border-input bg-transparent px-2 py-1 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring" ]), type_(DOM_HTML_Indexed_InputType.InputText.value), Halogen_HTML_Properties.placeholder("Find..."), Halogen_HTML_Properties.attr("data-find-input")("true") ]) ]), Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "hidden flex-1 max-w-xs" ]), Halogen_HTML_Properties.attr("data-replace-container")("true") ])([ Halogen_HTML_Elements.input([ Hydrogen_UI_Core.cls([ "flex h-7 w-full rounded-md border border-input bg-transparent px-2 py-1 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring" ]), type_(DOM_HTML_Indexed_InputType.InputText.value), Halogen_HTML_Properties.placeholder("Replace..."), Halogen_HTML_Properties.attr("data-replace-input")("true") ]) ]) ]);
};

// | Render side-by-side diff view
var renderSideBySideDiff = function (props) {
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "flex h-full" ]) ])([ Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "flex-1 border-r border-border overflow-auto" ]), Halogen_HTML_Properties.attr("data-diff-original")("true") ])([ Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "px-2 py-1 text-xs font-medium bg-muted/50 border-b border-border" ]) ])([ Halogen_HTML_Core.text("Original") ]), Halogen_HTML_Elements.pre([ Hydrogen_UI_Core.cls([ "m-0 p-2 font-mono text-sm leading-5 whitespace-pre" ]) ])([ Halogen_HTML_Elements.code_([ Halogen_HTML_Core.text(props.original) ]) ]) ]), Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "flex-1 overflow-auto" ]), Halogen_HTML_Properties.attr("data-diff-modified")("true") ])([ Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "px-2 py-1 text-xs font-medium bg-muted/50 border-b border-border" ]) ])([ Halogen_HTML_Core.text("Modified") ]), Halogen_HTML_Elements.pre([ Hydrogen_UI_Core.cls([ "m-0 p-2 font-mono text-sm leading-5 whitespace-pre" ]) ])([ Halogen_HTML_Elements.code_([ Halogen_HTML_Core.text(props.modified) ]) ]) ]) ]);
};

// | Render side by side (true) or inline (false)
var renderSideBySide = function (sbs) {
    return function (props) {
        return {
            original: props.original,
            modified: props.modified,
            language: props.language,
            theme: props.theme,
            className: props.className,
            height: props.height,
            renderSideBySide: sbs
        };
    };
};

// | Render minimap
var renderMinimap = function (props) {
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "flex-none w-24 bg-muted/20 border-l border-border overflow-hidden" ]), Halogen_HTML_Properties.attr("data-minimap")("true"), Halogen_HTML_Properties_ARIA.hidden("true") ])([ Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "p-1 text-[2px] leading-[3px] font-mono whitespace-pre overflow-hidden" ]), Halogen_HTML_Properties.style("transform: scale(0.2); transform-origin: top left; width: 500%;") ])([ Halogen_HTML_Core.text(props.value) ]) ]);
};

// | Render inline diff view
var renderInlineDiff = function (props) {
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "h-full overflow-auto" ]), Halogen_HTML_Properties.attr("data-diff-inline")("true") ])([ Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "px-2 py-1 text-xs font-medium bg-muted/50 border-b border-border" ]) ])([ Halogen_HTML_Core.text("Diff") ]), Halogen_HTML_Elements.pre([ Hydrogen_UI_Core.cls([ "m-0 p-2 font-mono text-sm leading-5 whitespace-pre" ]) ])([ Halogen_HTML_Elements.code_([ Halogen_HTML_Core.text("- " + (props.original + ("\x0a+ " + props.modified))) ]) ]) ]);
};

// | Render syntax-highlighted code
var renderHighlightedCode = function (props) {
    var wrapClass = (function () {
        if (props.wordWrap) {
            return " whitespace-pre-wrap break-words";
        };
        return "";
    })();
    return Halogen_HTML_Elements.pre([ Hydrogen_UI_Core.cls([ "m-0 p-0 font-mono text-sm leading-5 whitespace-pre" + wrapClass ]), Halogen_HTML_Properties.attr("data-language")(show3(props.language)) ])([ Halogen_HTML_Elements.code_([ Halogen_HTML_Core.text(props.value) ]) ]);
};

// | Render editor content area
var renderEditorContent = function (props) {
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "flex-1 overflow-auto" ]), Halogen_HTML_Properties.attr("data-editor-content")("true") ])([ Halogen_HTML_Elements.textarea([ Hydrogen_UI_Core.cls([ "absolute opacity-0 pointer-events-none" ]), value1(props.value), Halogen_HTML_Properties.readOnly(props.readOnly), Halogen_HTML_Properties.attr("data-editor-textarea")("true"), Halogen_HTML_Properties.attr("autocapitalize")("off"), Halogen_HTML_Properties.attr("autocomplete")("off"), Halogen_HTML_Properties.attr("autocorrect")("off"), Halogen_HTML_Properties.attr("spellcheck")("false") ]), Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "py-1 px-2" ]), Halogen_HTML_Properties.attr("data-highlighted-content")("true") ])([ renderHighlightedCode(props) ]) ]);
};

// | Redo last undone edit
var redo = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Unit.unit;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            return $foreign.redoImpl(maybeHandle.value0);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1133, column 3 - line 1135, column 48): " + [ maybeHandle.constructor.name ]);
    };
};

// | Set read-only mode
var readOnly = function (ro) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            readOnly: ro
        };
    };
};

// | Generate range of integers
var range = function (start) {
    return function (end) {
        return $foreign.rangeImpl(start)(end);
    };
};

// | Set original (left) content
var original = function (o) {
    return function (props) {
        return {
            modified: props.modified,
            language: props.language,
            theme: props.theme,
            renderSideBySide: props.renderSideBySide,
            className: props.className,
            height: props.height,
            original: o
        };
    };
};

// | Callback when selection changes
var onSelectionChange = function (handler) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            onSelectionChange: new Data_Maybe.Just(handler)
        };
    };
};

// | Callback for keydown events
var onKeyDown = function (handler) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: new Data_Maybe.Just(handler)
        };
    };
};

// | Callback when editor is initialized
var onInit = function (handler) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            onInit: new Data_Maybe.Just(handler)
        };
    };
};

// | Callback when editor gains focus
var onFocus = function (handler) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            onFocus: new Data_Maybe.Just(handler)
        };
    };
};

// | Callback when cursor position changes
var onCursorChange = function (handler) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            onCursorChange: new Data_Maybe.Just(handler)
        };
    };
};

// | Callback when content changes
var onChange = function (handler) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            onChange: new Data_Maybe.Just(handler)
        };
    };
};

// | Callback when editor loses focus
var onBlur = function (handler) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onKeyDown: props.onKeyDown,
            onBlur: new Data_Maybe.Just(handler)
        };
    };
};

// | Check if array is empty
var $$null = function (arr) {
    return $foreign.arrayLength(arr) === 0;
};

// | Set modified (right) content
var modified = function (m) {
    return function (props) {
        return {
            original: props.original,
            language: props.language,
            theme: props.theme,
            renderSideBySide: props.renderSideBySide,
            className: props.className,
            height: props.height,
            modified: m
        };
    };
};

// | Toggle minimap
var minimap = function (m) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            minimap: m
        };
    };
};

// | Set error/warning markers
var markers = function (m) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            markers: m
        };
    };
};

// | Map over array
var map = $foreign.mapImpl;

// | Toggle line numbers
var lineNumbers = function (ln) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            lineNumbers: ln
        };
    };
};

// | Set language for syntax highlighting
var language = function (l) {
    return function (props) {
        return {
            value: props.value,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            language: l
        };
    };
};

// | Insert text at cursor
var insertText = function (v) {
    return function (text) {
        return function __do() {
            var maybeHandle = Effect_Ref.read(v)();
            if (maybeHandle instanceof Data_Maybe.Nothing) {
                return Data_Unit.unit;
            };
            if (maybeHandle instanceof Data_Maybe.Just) {
                return $foreign.insertTextImpl(maybeHandle.value0, text);
            };
            throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1181, column 3 - line 1183, column 59): " + [ maybeHandle.constructor.name ]);
        };
    };
};

// | Create an info marker
var infoMarker = function (line) {
    return function (message) {
        return {
            line: line,
            column: 1,
            endLine: line,
            endColumn: 1000,
            message: message,
            severity: Info.value
        };
    };
};

// | Create a hint marker
var hintMarker = function (line) {
    return function (message) {
        return {
            line: line,
            column: 1,
            endLine: line,
            endColumn: 1000,
            message: message,
            severity: Hint.value
        };
    };
};

// | Highlight active line
var highlightActiveLine = function (hal) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            highlightActiveLine: hal
        };
    };
};

// | Set editor height
var height = function (h) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            height: h
        };
    };
};

// | Gutter classes
var gutterClasses = "select-none text-right pr-2 text-muted-foreground bg-muted/30";

// | Go to specific line
var goToLine = function (v) {
    return function (line) {
        return function __do() {
            var maybeHandle = Effect_Ref.read(v)();
            if (maybeHandle instanceof Data_Maybe.Nothing) {
                return Data_Unit.unit;
            };
            if (maybeHandle instanceof Data_Maybe.Just) {
                return $foreign.goToLineImpl(maybeHandle.value0, line);
            };
            throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1173, column 3 - line 1175, column 57): " + [ maybeHandle.constructor.name ]);
        };
    };
};

// | Get editor value
var getValue = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return "";
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            return $foreign.getValueImpl(maybeHandle.value0);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1057, column 3 - line 1059, column 52): " + [ maybeHandle.constructor.name ]);
    };
};

// | Get current selection
var getSelection = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Maybe.Nothing.value;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            var sel = $foreign.getSelectionImpl(maybeHandle.value0);
            return new Data_Maybe.Just(sel);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1073, column 3 - line 1077, column 22): " + [ maybeHandle.constructor.name ]);
    };
};

// | Get editor state
var getEditorState = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Maybe.Nothing.value;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            var val = $foreign.getValueImpl(maybeHandle.value0);
            var pos = $foreign.getCursorPositionImpl(maybeHandle.value0);
            var sels = $foreign.getSelectionsImpl(maybeHandle.value0);
            return new Data_Maybe.Just({
                value: val,
                cursorPosition: pos,
                selections: sels,
                scrollTop: 0.0,
                scrollLeft: 0.0,
                isFocused: false
            });
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1038, column 3 - line 1051, column 10): " + [ maybeHandle.constructor.name ]);
    };
};

// | Get cursor position
var getCursorPosition = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Maybe.Nothing.value;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            var pos = $foreign.getCursorPositionImpl(maybeHandle.value0);
            return new Data_Maybe.Just(pos);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1091, column 3 - line 1095, column 22): " + [ maybeHandle.constructor.name ]);
    };
};

// | Format document
var format = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Unit.unit;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            return $foreign.formatImpl(maybeHandle.value0);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1141, column 3 - line 1143, column 50): " + [ maybeHandle.constructor.name ]);
    };
};

// | Fold all code blocks
var foldAll = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Unit.unit;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            return $foreign.foldAllImpl(maybeHandle.value0);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1189, column 3 - line 1191, column 51): " + [ maybeHandle.constructor.name ]);
    };
};

// | Focus the editor
var focus = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Unit.unit;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            return $foreign.focusEditorImpl(maybeHandle.value0);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1109, column 3 - line 1111, column 55): " + [ maybeHandle.constructor.name ]);
    };
};

// | Open find dialog
var find = function (v) {
    return function (query) {
        return function __do() {
            var maybeHandle = Effect_Ref.read(v)();
            if (maybeHandle instanceof Data_Maybe.Nothing) {
                return Data_Unit.unit;
            };
            if (maybeHandle instanceof Data_Maybe.Just) {
                return $foreign.findImpl(maybeHandle.value0, query);
            };
            throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1149, column 3 - line 1151, column 54): " + [ maybeHandle.constructor.name ]);
        };
    };
};

// | Error marker classes
var errorMarkerClasses = "bg-destructive/20 border-l-2 border-destructive";

// | Render a single marker
var renderMarker = function (marker) {
    var topOffset = (marker.line - 1 | 0) * 20 | 0;
    var markerClass = (function () {
        if (marker.severity instanceof $$Error) {
            return errorMarkerClasses;
        };
        if (marker.severity instanceof Warning) {
            return warningMarkerClasses;
        };
        if (marker.severity instanceof Info) {
            return "bg-blue-500/20 border-l-2 border-blue-500";
        };
        if (marker.severity instanceof Hint) {
            return "bg-green-500/20 border-l-2 border-green-500";
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 892, column 19 - line 896, column 60): " + [ marker.severity.constructor.name ]);
    })();
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "absolute left-12 right-0 h-5", markerClass ]), Halogen_HTML_Properties.style("top: " + (show(topOffset) + "px")), Halogen_HTML_Properties.title(marker.message), Halogen_HTML_Properties.attr("data-marker-line")(show(marker.line)), Halogen_HTML_Properties.attr("data-marker-severity")(show2(marker.severity)) ])([  ]);
};

// | Render error/warning markers
var renderMarkers = function (props) {
    var $150 = $$null(props.markers);
    if ($150) {
        return Halogen_HTML_Core.text("");
    };
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "absolute top-0 left-0 right-0 pointer-events-none" ]), Halogen_HTML_Properties.attr("data-markers")("true") ])(map(renderMarker)(props.markers));
};

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                 // marker utils
// ═══════════════════════════════════════════════════════════════════════════════
// | Create an error marker
var errorMarker = function (line) {
    return function (message) {
        return {
            line: line,
            column: 1,
            endLine: line,
            endColumn: 1000,
            message: message,
            severity: $$Error.value
        };
    };
};
var eqTheme = {
    eq: function (x) {
        return function (y) {
            if (x instanceof Light && y instanceof Light) {
                return true;
            };
            if (x instanceof Dark && y instanceof Dark) {
                return true;
            };
            return false;
        };
    }
};
var eqMarkerSeverity = {
    eq: function (x) {
        return function (y) {
            if (x instanceof $$Error && y instanceof $$Error) {
                return true;
            };
            if (x instanceof Warning && y instanceof Warning) {
                return true;
            };
            if (x instanceof Info && y instanceof Info) {
                return true;
            };
            if (x instanceof Hint && y instanceof Hint) {
                return true;
            };
            return false;
        };
    }
};
var eq1 = /* #__PURE__ */ Data_Eq.eq(eqMarkerSeverity);
var eqLanguage = {
    eq: function (x) {
        return function (y) {
            if (x instanceof JavaScript && y instanceof JavaScript) {
                return true;
            };
            if (x instanceof TypeScript && y instanceof TypeScript) {
                return true;
            };
            if (x instanceof HTML && y instanceof HTML) {
                return true;
            };
            if (x instanceof CSS && y instanceof CSS) {
                return true;
            };
            if (x instanceof $$JSON && y instanceof $$JSON) {
                return true;
            };
            if (x instanceof Markdown && y instanceof Markdown) {
                return true;
            };
            if (x instanceof PureScript && y instanceof PureScript) {
                return true;
            };
            if (x instanceof PlainText && y instanceof PlainText) {
                return true;
            };
            return false;
        };
    }
};

// | Check if element is in array
var elem = function (dictEq) {
    var eq2 = Data_Eq.eq(dictEq);
    return function (x) {
        return function (arr) {
            return $foreign.arrayLength(Data_Array.filter(function (v) {
                return eq2(v)(x);
            })(arr)) > 0;
        };
    };
};
var elem1 = /* #__PURE__ */ elem(Data_Eq.eqInt);

// | Render a single line number
var renderLineNumber = function (errorLines) {
    return function (warningLines) {
        return function (line) {
            var hasWarning = elem1(line)(warningLines);
            var hasError = elem1(line)(errorLines);
            var markerClass = (function () {
                if (hasError) {
                    return "text-destructive font-bold";
                };
                if (hasWarning) {
                    return "text-yellow-500 font-bold";
                };
                return "";
            })();
            return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "h-5 leading-5 text-xs", markerClass ]), Halogen_HTML_Properties.attr("data-line-number")(show(line)) ])([ Halogen_HTML_Core.text(show(line)) ]);
        };
    };
};

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                  // components
// ═══════════════════════════════════════════════════════════════════════════════
// | Base editor container classes
var editorContainerClasses = "relative rounded-md border border-border bg-background overflow-hidden font-mono text-sm";

// | Set diff theme
var diffTheme = function (t) {
    return function (props) {
        return {
            original: props.original,
            modified: props.modified,
            language: props.language,
            renderSideBySide: props.renderSideBySide,
            className: props.className,
            height: props.height,
            theme: t
        };
    };
};

// | Set diff language
var diffLanguage = function (l) {
    return function (props) {
        return {
            original: props.original,
            modified: props.modified,
            theme: props.theme,
            renderSideBySide: props.renderSideBySide,
            className: props.className,
            height: props.height,
            language: l
        };
    };
};

// | Set diff editor height
var diffHeight = function (h) {
    return function (props) {
        return {
            original: props.original,
            modified: props.modified,
            language: props.language,
            theme: props.theme,
            renderSideBySide: props.renderSideBySide,
            className: props.className,
            height: h
        };
    };
};

// | Add custom class to diff editor
var diffClassName = function (c) {
    return function (props) {
        return {
            original: props.original,
            modified: props.modified,
            language: props.language,
            theme: props.theme,
            renderSideBySide: props.renderSideBySide,
            height: props.height,
            className: props.className + (" " + c)
        };
    };
};

// ═══════════════════════════════════════════════════════════════════════════════
//                                                         // language detection
// ═══════════════════════════════════════════════════════════════════════════════
// | Detect language from filename
// |
// | ```purescript
// | detectLanguage "app.js"      -- Just JavaScript
// | detectLanguage "styles.css"  -- Just CSS
// | detectLanguage "unknown.xyz" -- Nothing
// | ```
var detectLanguage = function (filename) {
    
    // Safe in context because we check for empty array
var unsafeLast = function (arr) {
        var len = $foreign.arrayLength(arr);
        return $foreign.unsafeIndex(arr)(len - 1 | 0);
    };
    var lastElement = function (arr) {
        if (arr.length === 0) {
            return Data_Maybe.Nothing.value;
        };
        return new Data_Maybe.Just(unsafeLast(arr));
    };
    var getExtension = function (fname) {
        var parts = Data_String_Common.split(".")(fname);
        if (parts.length === 0) {
            return "";
        };
        return Data_Maybe.fromMaybe("")(lastElement(parts));
    };
    var ext = getExtension(filename);
    if (ext === "js") {
        return new Data_Maybe.Just(JavaScript.value);
    };
    if (ext === "jsx") {
        return new Data_Maybe.Just(JavaScript.value);
    };
    if (ext === "mjs") {
        return new Data_Maybe.Just(JavaScript.value);
    };
    if (ext === "cjs") {
        return new Data_Maybe.Just(JavaScript.value);
    };
    if (ext === "ts") {
        return new Data_Maybe.Just(TypeScript.value);
    };
    if (ext === "tsx") {
        return new Data_Maybe.Just(TypeScript.value);
    };
    if (ext === "mts") {
        return new Data_Maybe.Just(TypeScript.value);
    };
    if (ext === "cts") {
        return new Data_Maybe.Just(TypeScript.value);
    };
    if (ext === "html") {
        return new Data_Maybe.Just(HTML.value);
    };
    if (ext === "htm") {
        return new Data_Maybe.Just(HTML.value);
    };
    if (ext === "xhtml") {
        return new Data_Maybe.Just(HTML.value);
    };
    if (ext === "css") {
        return new Data_Maybe.Just(CSS.value);
    };
    if (ext === "scss") {
        return new Data_Maybe.Just(CSS.value);
    };
    if (ext === "sass") {
        return new Data_Maybe.Just(CSS.value);
    };
    if (ext === "less") {
        return new Data_Maybe.Just(CSS.value);
    };
    if (ext === "json") {
        return new Data_Maybe.Just($$JSON.value);
    };
    if (ext === "jsonc") {
        return new Data_Maybe.Just($$JSON.value);
    };
    if (ext === "md") {
        return new Data_Maybe.Just(Markdown.value);
    };
    if (ext === "markdown") {
        return new Data_Maybe.Just(Markdown.value);
    };
    if (ext === "mdx") {
        return new Data_Maybe.Just(Markdown.value);
    };
    if (ext === "purs") {
        return new Data_Maybe.Just(PureScript.value);
    };
    return Data_Maybe.Nothing.value;
};

// | Default editor properties
var defaultProps = /* #__PURE__ */ (function () {
    return {
        value: "",
        language: PlainText.value,
        theme: Light.value,
        lineNumbers: true,
        readOnly: false,
        minimap: false,
        wordWrap: false,
        tabSize: 2,
        useTabs: false,
        autoCloseBrackets: true,
        autoCloseQuotes: true,
        bracketMatching: true,
        highlightActiveLine: true,
        codeFolding: true,
        markers: [  ],
        className: "",
        height: "400px",
        onInit: Data_Maybe.Nothing.value,
        onChange: Data_Maybe.Nothing.value,
        onCursorChange: Data_Maybe.Nothing.value,
        onSelectionChange: Data_Maybe.Nothing.value,
        onFocus: Data_Maybe.Nothing.value,
        onBlur: Data_Maybe.Nothing.value,
        onKeyDown: Data_Maybe.Nothing.value
    };
})();

// | Default diff editor properties
var defaultDiffProps = /* #__PURE__ */ (function () {
    return {
        original: "",
        modified: "",
        language: PlainText.value,
        theme: Light.value,
        renderSideBySide: true,
        className: "",
        height: "400px"
    };
})();

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                 // diff editor
// ═══════════════════════════════════════════════════════════════════════════════
// | Render diff editor (two-pane comparison)
var diffEditor = function (propMods) {
    var props = Data_Array.foldl(function (p) {
        return function (f) {
            return f(p);
        };
    })(defaultDiffProps)(propMods);
    var themeClass = (function () {
        if (props.theme instanceof Dark) {
            return "code-editor-dark";
        };
        if (props.theme instanceof Light) {
            return "code-editor-light";
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 962, column 18 - line 964, column 35): " + [ props.theme.constructor.name ]);
    })();
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "relative rounded-md border border-border bg-background overflow-hidden", themeClass, props.className ]), Halogen_HTML_Properties.style("height: " + props.height), Halogen_HTML_Properties.attr("data-diff-editor")("true") ])([ (function () {
        if (props.renderSideBySide) {
            return renderSideBySideDiff(props);
        };
        return renderInlineDiff(props);
    })() ]);
};

// ═══════════════════════════════════════════════════════════════════════════════
//                                                              // imperative api
// ═══════════════════════════════════════════════════════════════════════════════
// | Create an editor ref for imperative operations
var createEditorRef = /* #__PURE__ */ (function () {
    return Data_Functor.map(Effect.functorEffect)(EditorRef)(Effect_Ref["new"](Data_Maybe.Nothing.value));
})();

// | Count markers of a specific severity
var countMarkers = function (severity) {
    return function (markers$prime) {
        return $foreign.arrayLength(Data_Array.filter(function (m) {
            return eq1(m.severity)(severity);
        })(markers$prime));
    };
};

// ═══════════════════════════════════════════════════════════════════════════════
//                                                                     // helpers
// ═══════════════════════════════════════════════════════════════════════════════
// | Count lines in text
var countLines = function (text) {
    var lines = Data_String_Common.split("\x0a")(text);
    return max(1)($foreign.arrayLength(lines));
};

// | Render line numbers gutter
var renderGutter = function (props) {
    var warningLines = map(function (v) {
        return v.line;
    })(Data_Array.filter(function (m) {
        return eq1(m.severity)(Warning.value);
    })(props.markers));
    var lineCount = countLines(props.value);
    var errorLines = map(function (v) {
        return v.line;
    })(Data_Array.filter(function (m) {
        return eq1(m.severity)($$Error.value);
    })(props.markers));
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ gutterClasses, "flex-none w-12 py-1 overflow-hidden" ]), Halogen_HTML_Properties.attr("data-gutter")("true"), Halogen_HTML_Properties_ARIA.hidden("true") ])(map(renderLineNumber(errorLines)(warningLines))(range(1)(lineCount)));
};

// | Render status bar
var renderStatusBar = function (props) {
    var warningCount = countMarkers(Warning.value)(props.markers);
    var lineCount = countLines(props.value);
    var langDisplay = show3(props.language);
    var errorCount = countMarkers($$Error.value)(props.markers);
    var charCount = Data_String_CodePoints.length(props.value);
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "absolute bottom-0 left-0 right-0 flex items-center justify-between px-2 py-0.5 text-xs text-muted-foreground bg-muted/30 border-t border-border" ]), Halogen_HTML_Properties.attr("data-status-bar")("true") ])([ Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "flex items-center gap-2" ]) ])([ Halogen_HTML_Elements.span([ Halogen_HTML_Properties.attr("data-cursor-position")("true") ])([ Halogen_HTML_Core.text("Ln 1, Col 1") ]), Halogen_HTML_Elements.span([  ])([ Halogen_HTML_Core.text("|") ]), Halogen_HTML_Elements.span([  ])([ Halogen_HTML_Core.text(show(lineCount) + " lines") ]), Halogen_HTML_Elements.span([  ])([ Halogen_HTML_Core.text("|") ]), Halogen_HTML_Elements.span([  ])([ Halogen_HTML_Core.text(show(charCount) + " chars") ]) ]), Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "flex items-center gap-2" ]) ])([ (function () {
        var $164 = errorCount > 0;
        if ($164) {
            return Halogen_HTML_Elements.span([ Hydrogen_UI_Core.cls([ "text-destructive" ]) ])([ Halogen_HTML_Core.text(show(errorCount) + " errors") ]);
        };
        return Halogen_HTML_Core.text("");
    })(), (function () {
        var $165 = warningCount > 0;
        if ($165) {
            return Halogen_HTML_Elements.span([ Hydrogen_UI_Core.cls([ "text-yellow-500" ]) ])([ Halogen_HTML_Core.text(show(warningCount) + " warnings") ]);
        };
        return Halogen_HTML_Core.text("");
    })(), Halogen_HTML_Elements.span([  ])([ Halogen_HTML_Core.text(langDisplay) ]), (function () {
        if (props.readOnly) {
            return Halogen_HTML_Elements.span([ Hydrogen_UI_Core.cls([ "text-muted-foreground" ]) ])([ Halogen_HTML_Core.text("[Read-only]") ]);
        };
        return Halogen_HTML_Core.text("");
    })() ]) ]);
};

// | Enable code folding
var codeFolding = function (cf) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            codeFolding: cf
        };
    };
};

// | Render the code editor
var codeEditor = function (propMods) {
    var props = Data_Array.foldl(function (p) {
        return function (f) {
            return f(p);
        };
    })(defaultProps)(propMods);
    var themeClass = (function () {
        if (props.theme instanceof Dark) {
            return "code-editor-dark";
        };
        if (props.theme instanceof Light) {
            return "code-editor-light";
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 711, column 18 - line 713, column 35): " + [ props.theme.constructor.name ]);
    })();
    var editorId = "code-editor-" + show(Data_String_CodePoints.length(props.value));
    return Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ editorContainerClasses, themeClass, props.className ]), Halogen_HTML_Properties.style("height: " + props.height), Halogen_HTML_Properties.id(editorId), Halogen_HTML_Properties.attr("data-language")(show3(props.language)), Halogen_HTML_Properties.attr("data-theme")(show1(props.theme)), Halogen_HTML_Properties.attr("data-line-numbers")((function () {
        if (props.lineNumbers) {
            return "true";
        };
        return "false";
    })()), Halogen_HTML_Properties.attr("data-read-only")((function () {
        if (props.readOnly) {
            return "true";
        };
        return "false";
    })()), Halogen_HTML_Properties.attr("data-minimap")((function () {
        if (props.minimap) {
            return "true";
        };
        return "false";
    })()), Halogen_HTML_Properties.attr("data-word-wrap")((function () {
        if (props.wordWrap) {
            return "true";
        };
        return "false";
    })()), Halogen_HTML_Properties.attr("data-tab-size")(show(props.tabSize)), Halogen_HTML_Properties.attr("data-use-tabs")((function () {
        if (props.useTabs) {
            return "true";
        };
        return "false";
    })()), Halogen_HTML_Properties.attr("data-auto-close-brackets")((function () {
        if (props.autoCloseBrackets) {
            return "true";
        };
        return "false";
    })()), Halogen_HTML_Properties.attr("data-bracket-matching")((function () {
        if (props.bracketMatching) {
            return "true";
        };
        return "false";
    })()), Halogen_HTML_Properties.attr("data-highlight-active-line")((function () {
        if (props.highlightActiveLine) {
            return "true";
        };
        return "false";
    })()), Halogen_HTML_Properties.attr("data-code-folding")((function () {
        if (props.codeFolding) {
            return "true";
        };
        return "false";
    })()), Halogen_HTML_Properties_ARIA.role("textbox"), Halogen_HTML_Properties_ARIA.label("Code editor"), Halogen_HTML_Properties.attr("aria-multiline")("true") ])([ renderToolbar(props), Halogen_HTML_Elements.div([ Hydrogen_UI_Core.cls([ "flex h-full" ]) ])([ (function () {
        if (props.lineNumbers) {
            return renderGutter(props);
        };
        return Halogen_HTML_Core.text("");
    })(), renderEditorContent(props), (function () {
        if (props.minimap) {
            return renderMinimap(props);
        };
        return Halogen_HTML_Core.text("");
    })() ]), renderMarkers(props), renderStatusBar(props) ]);
};

// | Add custom class
var className = function (c) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            className: props.className + (" " + c)
        };
    };
};

// | Enable bracket matching
var bracketMatching = function (bm) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            autoCloseQuotes: props.autoCloseQuotes,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            bracketMatching: bm
        };
    };
};

// | Blur the editor
var blur = function (v) {
    return function __do() {
        var maybeHandle = Effect_Ref.read(v)();
        if (maybeHandle instanceof Data_Maybe.Nothing) {
            return Data_Unit.unit;
        };
        if (maybeHandle instanceof Data_Maybe.Just) {
            return $foreign.blurEditorImpl(maybeHandle.value0);
        };
        throw new Error("Failed pattern match at Hydrogen.Editor.Code (line 1117, column 3 - line 1119, column 54): " + [ maybeHandle.constructor.name ]);
    };
};

// | Auto-close quotes
var autoCloseQuotes = function (acq) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseBrackets: props.autoCloseBrackets,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            autoCloseQuotes: acq
        };
    };
};

// | Auto-close brackets
var autoCloseBrackets = function (acb) {
    return function (props) {
        return {
            value: props.value,
            language: props.language,
            theme: props.theme,
            lineNumbers: props.lineNumbers,
            readOnly: props.readOnly,
            minimap: props.minimap,
            wordWrap: props.wordWrap,
            tabSize: props.tabSize,
            useTabs: props.useTabs,
            autoCloseQuotes: props.autoCloseQuotes,
            bracketMatching: props.bracketMatching,
            highlightActiveLine: props.highlightActiveLine,
            codeFolding: props.codeFolding,
            markers: props.markers,
            className: props.className,
            height: props.height,
            onInit: props.onInit,
            onChange: props.onChange,
            onCursorChange: props.onCursorChange,
            onSelectionChange: props.onSelectionChange,
            onFocus: props.onFocus,
            onBlur: props.onBlur,
            onKeyDown: props.onKeyDown,
            autoCloseBrackets: acb
        };
    };
};

// | Active line highlight classes (used by JS for dynamic highlighting)
var _activeLineClasses = "bg-muted/50";
export {
    codeEditor,
    diffEditor,
    JavaScript,
    TypeScript,
    HTML,
    CSS,
    $$JSON as JSON,
    Markdown,
    PureScript,
    PlainText,
    detectLanguage,
    Light,
    Dark,
    $$Error as Error,
    Warning,
    Info,
    Hint,
    errorMarker,
    warningMarker,
    infoMarker,
    hintMarker,
    value,
    language,
    theme,
    lineNumbers,
    readOnly,
    minimap,
    wordWrap,
    tabSize,
    useTabs,
    autoCloseBrackets,
    autoCloseQuotes,
    bracketMatching,
    highlightActiveLine,
    codeFolding,
    markers,
    className,
    height,
    onInit,
    onChange,
    onCursorChange,
    onSelectionChange,
    onFocus,
    onBlur,
    onKeyDown,
    original,
    modified,
    diffLanguage,
    diffTheme,
    renderSideBySide,
    diffClassName,
    diffHeight,
    getEditorState,
    createEditorRef,
    getValue,
    setValue,
    getSelection,
    setSelection,
    getCursorPosition,
    setCursorPosition,
    focus,
    blur,
    undo,
    redo,
    format,
    find,
    replace,
    replaceAll,
    goToLine,
    insertText,
    foldAll,
    unfoldAll,
    eqLanguage,
    showLanguage,
    eqTheme,
    showTheme,
    eqMarkerSeverity,
    showMarkerSeverity
};
